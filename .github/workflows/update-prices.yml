name: Update Cota√ß√µes

on:
  schedule:
      # Executa 4x por dia: 8h, 12h, 15h, 17h (hor√°rio UTC)
          - cron: '0 11,15,18,20 * * 1-5'  # Segunda a sexta
            workflow_dispatch: # Permite execu√ß√£o manual

            jobs:
              update-prices:
                  runs-on: ubuntu-latest

                          steps:
                              - name: Checkout repository
                                    uses: actions/checkout@v3

                                              - name: Setup Python
                                                    uses: actions/setup-python@v4
                                                          with:
                                                                  python-version: '3.11'

                                                                              - name: Install dependencies
                                                                                    run: |
                                                                                            pip install requests openai
                                                                                                    
                                                                                                        - name: Run price fetcher
                                                                                                              run: |
                                                                                                                      python fetch-prices-chatgpt.py
                                                                                                                              
                                                                                                                                  - name: Commit and push changes
                                                                                                                                        run: |
                                                                                                                                                git config --local user.email "action@github.com"
                                                                                                                                                        git config --local user.name "GitHub Action"
                                                                                                                                                                git add prices.json
                                                                                                                                                                        git diff --staged --quiet || git commit -m "ü§ñ Atualizar cota√ß√µes - $(date '+%d/%m/%Y %H:%M')"
                                                                                                                                                                                git push
